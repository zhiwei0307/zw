import"./vue.bba2ec4d.js";import{_ as z,B as S,i as I}from"./index.57d03647.js";import{_ as Z}from"./lodash.20dab116.js";import{d as N,e as P,m as _,f as g,_ as t,v as R,$ as T,a0 as M,a1 as o,c as n,B as k,t as h,h as j,E as q,a3 as W}from"./@vue.ce69bcce.js";import{T as G}from"./@ant-design.dce0d0de.js";import"./ant-design-vue.4bd4cff1.js";import"./@babel.d77ec770.js";import"./regenerator-runtime.52b57d8c.js";import"./lodash-es.a7598bc1.js";import"./resize-observer-polyfill.8deb1e21.js";import"./dayjs.3e893def.js";import"./vue-types.6e6d84ba.js";import"./@ctrl.837ec117.js";import"./dom-align.243fa364.js";import"./async-validator.ed4c92a2.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./vuex.6a416a8d.js";import"./axios.e9656f83.js";import"./vue-router.b7fb3786.js";import"./nprogress.bfa0410b.js";import"./js-cookie.31874410.js";import"./clipboard.4ddab532.js";const H=N({name:"brand",components:{BrandCascader:S},setup(){const e=P("context"),a=e.$store,f=_(!1),C=_(null),F=g(()=>a.state.machine.brands);I(F.value)&&a.dispatch("machine/get_brands_action");const E=[{title:"ID",dataIndex:"b_id",width:60,align:"center"},{title:"\u540D\u79F0",dataIndex:"b_name",width:260},{title:"\u6392\u5E8F",dataIndex:"b_sort",width:100,align:"center"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"b_intime",width:192,align:"center"},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"b_utime",width:192,align:"center"},{title:"\u5907\u6CE8/\u63CF\u8FF0",dataIndex:"b_intro",ellipsis:!0},{title:"\u64CD\u4F5C",dataIndex:"action",align:"center",width:108,slots:{customRender:"action"}}],r=_(!1),u=_(""),w=g(()=>!(u.value==="view"||!u.value)),i=_({}),b=g(()=>i.value.b_id||Math.random().toFixed(10)),m=function(){f.value=!0,a.dispatch("machine/get_brands_action").finally(()=>{f.value=!1})};return{columns:E,listdata:F,loading:f,visible:r,mode:u,canEdit:w,formkey:b,foo:i,handleAdd:()=>{i.value={},r.value=!0,u.value="add"},handleEdit:({record:l})=>{i.value=Z.cloneDeep(l),r.value=!0,u.value="edit"},handleView:({record:l})=>{i.value=l,r.value=!0,u.value="view"},handleDel:({record:l})=>{e.$modal.confirm({title:"\u8B66\u544A",content:"\u786E\u5B9A\u5220\u9664\u4E48\uFF1F",icon:j(G),okText:"\u786E\u5B9A",okType:"danger",onOk(){return new Promise(c=>{e.$http.delete("brand/"+l.b_id).then(s=>{m(),e.$message.open({content:s.message,type:s.success?"success":"error"}),c(s)})})}})},handerBrandCascaderChange:l=>{I(l)||(i.value.b_pid=l[l.length-1],i.value.b_all_path=`${l.join("-")}-${i.value.b_id}`)},handleFormOk:()=>{let l="brand",c="post";u.value==="edit"&&(c="put",l+="/"+i.value.b_id,delete i.value.id,delete i.value.children),e.$http[c](l,i.value).then(s=>{m(),r.value=!1,e.$message.open({content:s.message,type:s.success?"success":"error"})}).finally(()=>{C.value.submiting=!1})},queryAction:m,zwModal:C}}}),J=q(" \u65B0\u589E "),K=W("i",null,null,-1);function L(e,a,f,C,F,E){const r=t("PlusOutlined"),u=t("a-button"),w=t("ReloadOutlined"),i=t("a-button-group"),b=t("a-col"),m=t("a-row"),y=t("EditFilled"),B=t("EyeOutlined"),$=t("DeleteTwoTone"),D=t("a-table"),A=t("BrandCascader"),p=t("a-form-item"),l=t("a-input"),c=t("a-textarea"),s=t("a-form"),U=t("ZwModal"),V=t("ZwScrollbar"),v=R("can-edit");return T(),M(V,{"wrap-class":"pd-17"},{default:o(()=>[n(m,{style:{"margin-bottom":"15px"}},{default:o(()=>[n(b,{span:18},{default:o(()=>[n(i,null,{default:o(()=>[n(u,{onClick:e.handleAdd},{icon:o(()=>[n(r)]),default:o(()=>[J]),_:1},8,["onClick"]),n(u,{onClick:e.queryAction},{icon:o(()=>[n(w)]),default:o(()=>[K]),_:1},8,["onClick"])]),_:1})]),_:1}),n(b,{span:6})]),_:1}),n(D,{"row-key":"b_id",columns:e.columns,"data-source":e.listdata,loading:e.loading,"indent-size":25,expandIconColumnIndex:1,bordered:"",pagination:!1,size:"small",style:{width:"100%"}},{action:o(d=>[n(i,null,{default:o(()=>[n(u,{type:"link",onClick:k(O=>e.handleEdit(d),["stop"])},{icon:o(()=>[n(y)]),_:2},1032,["onClick"]),n(u,{type:"link",onClick:k(O=>e.handleView(d),["stop"])},{icon:o(()=>[n(B,{style:{color:"#606266"}})]),_:2},1032,["onClick"]),n(u,{type:"link",onClick:k(O=>e.handleDel(d),["stop"])},{icon:o(()=>[n($,{twoToneColor:"#ff4d4f"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["columns","data-source","loading"]),n(U,{ref:"zwModal",visible:e.visible,"onUpdate:visible":a[4]||(a[4]=d=>e.visible=d),mode:e.mode,"onUpdate:mode":a[5]||(a[5]=d=>e.mode=d),title:"\u54C1\u724C\u4FE1\u606F\u7F16\u8F91",width:520,"mask-closable":!1,onSubmit:e.handleFormOk},{default:o(()=>[(T(),M(s,{ref:"brandForm",model:e.foo,key:e.formkey,"label-col":{span:5},"wrapper-col":{span:16}},{default:o(()=>[n(p,{label:"\u4E0A\u7EA7\u540D\u79F0"},{default:o(()=>[h(n(A,{brands:e.foo.b_p_path,"onUpdate:brands":a[0]||(a[0]=d=>e.foo.b_p_path=d),onChange:e.handerBrandCascaderChange},null,8,["brands","onChange"]),[[v,e.canEdit]])]),_:1}),n(p,{label:"\u54C1\u724C\u540D\u79F0"},{default:o(()=>[h(n(l,{value:e.foo.b_name,"onUpdate:value":a[1]||(a[1]=d=>e.foo.b_name=d),placeholder:"\u54C1\u724C\u540D\u79F0"},null,8,["value"]),[[v,e.canEdit]])]),_:1}),n(p,{label:"\u6392\u5E8F"},{default:o(()=>[h(n(l,{value:e.foo.b_sort,"onUpdate:value":a[2]||(a[2]=d=>e.foo.b_sort=d),valueModifiers:{number:!0},placeholder:"\u6392\u5E8F"},null,8,["value"]),[[v,e.canEdit]])]),_:1}),n(p,{label:"\u63CF\u8FF0"},{default:o(()=>[h(n(c,{value:e.foo.b_intro,"onUpdate:value":a[3]||(a[3]=d=>e.foo.b_intro=d),placeholder:"\u63CF\u8FF0"},null,8,["value"]),[[v,e.canEdit]])]),_:1})]),_:1},8,["model"]))]),_:1},8,["visible","mode","onSubmit"])]),_:1})}var Ce=z(H,[["render",L]]);export{Ce as default};
